<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Partidos en Vivo - Actualiza para ver m√°s</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <meta name="referrer" content="no-referrer-when-downgrade">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: white;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
        }
        header {
            background-color: #232323;
            padding: 15px;
            text-align: center;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        h1 {
            margin: 0;
            color: #f1c40f;
            font-size: 24px;
        }
        .partido {
            background-color: #2c3e50;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .partido:hover {
            background-color: #34495e;
        }
        .partido video {
            width: 100%;
            max-height: 500px;
            margin-top: 10px;
        }
        .live-indicator {
            background-color: #e74c3c;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            font-weight: bold;
        }
        .refresh-button {
            width: 100%;
            padding: 10px;
            background-color: #f1c40f;
            border: none;
            color: black;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 0;
        }
        .support-message {
            text-align: center;
            color: #bdc3c7;
            margin-bottom: 10px;
        }
        .ad-container {
            margin: 15px auto;
            text-align: center;
            overflow: hidden;
            min-height: 120px;
            background-color: rgba(255,255,255,0.05);
            border: 1px dashed #f1c40f;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .ad-container iframe {
            max-width: 100%;
            max-height: 100%;
        }
        .ad-notice {
            font-size: 10px;
            color: #999;
            margin-top: 3px;
            font-style: italic;
            text-align: center;
        }
        footer {
            text-align: center;
            padding: 10px;
            background-color: #232323;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Partidos en Vivo - Actualiza para ver m√°s</h1>
        </header>
        
        <div class="support-message">
            Los anuncios nos ayudan a mantener este servicio gratuito. ¬°Gracias por tu apoyo!
        </div>
        
        <button class="refresh-button" onclick="window.location.reload()">
            üîÑ ACTUALIZAR PARA VER TODOS LOS PARTIDOS
        </button>
        
        <!-- Top Ad Container -->
        <div class="ad-container" id="ad-top">
            <div class="ad-banner">
                <script type="text/javascript">
                    atOptions = {
                        'key': 'b330ccd204185aee9ef640adccf896d2',
                        'format': 'iframe',
                        'height': 90,
                        'width': 728,
                        'params': {}
                    };
                    document.write('<scr' + 'ipt type="text/javascript" src="//www.highperformanceformat.com/b330ccd204185aee9ef640adccf896d2/invoke.js"></scr' + 'ipt>');
                </script>
            </div>
            <div class="ad-notice">Anuncio - Apoya nuestro servicio</div>
        </div>

        <!-- Middle Ad Containers -->
        <div class="ad-container" id="ad-mid-1">
            <div id="container-mid-1">
                <script async src="//pl26063295.effectiveratecpm.com/2537ae2ea8b16bc9e554273a94dfd098/invoke.js"></script>
                <div id="container-2537ae2ea8b16bc9e554273a94dfd098"></div>
            </div>
            <div class="ad-notice">Anuncio - Haz clic para apoyarnos</div>
        </div>
        
        <div class="ad-container" id="ad-mid-2">
            <div id="container-mid-2">
                <script async src="//pl26063295.effectiveratecpm.com/2537ae2ea8b16bc9e554273a94dfd098/invoke.js"></script>
                <div id="container-mid-2-content"></div>
            </div>
            <div class="ad-notice">Anuncio - Haz clic para apoyarnos</div>
        </div>

        <div class="partidos">
            <div class="partido" data-stream-url="https://bgfuzq.fubohd.com/caracol/mono.m3u8?token=3ee198f65dba5df2a32f3dfb8ca181575c98b3f4-bd-1742979808-1742943808">
                <div class="live-indicator">EN VIVO</div>
                <h3>18:30pm</h3>
                <div class="tiempo">Clasificaci√≥n para la Copa Mundial: Venezuela vs Peru</div>
            </div>
        </div>

        <div class="partidos">
            <div class="partido" data-stream-url="https://c3bvcnrz.pelotahd.com/americatv/mono.m3u8?token=fdf07d2ddfa831260a58686ea81758b6ca4309f7-20-1742979226-1742943226">
                <div class="live-indicator">EN VIVO</div>
                <h3>18:30pm</h3>
                <div class="tiempo">Eliminatorias Sudamericanas 2026: Colombia vs Paraguay</div>
            </div>
        </div>

        <div class="partidos">
            <div class="partido" data-stream-url="https://z29vzc.pelotahd.com/movistar_eventos2/mono.m3u8?token=473f69394fa81e06c6f22f915c40c9a1552ed4b0-33-1742979775-1742943775">
                <div class="live-indicator">EN VIVO</div>
                <h3>18:30pm</h3>
                <div class="tiempo">Eliminatorias Sudamericanas 2026: Chile vs Ecuador</div>
            </div>
        </div>

        <div class="partidos">
            <div class="partido" data-stream-url="https://bmf0aw9u.fubohd.com/tvpublica/mono.m3u8?token=8c16e11759c8a5babd51754e44dbafc4fb1689a6-69-1742979745-1742943745">
                <div class="live-indicator">EN VIVO</div>
                <h3>18:30pm</h3>
                <div class="tiempo">Eliminatorias Sudamericanas 2026: Argentina vs Brasil</div>
            </div>
        </div>
        
        <button class="refresh-button" onclick="mostrarMasPartidos()">
            üëâ VER M√ÅS PARTIDOS DISPONIBLES üëà
        </button>
        
        <!-- Bottom Ad Container -->
        <div class="ad-container" id="ad-bottom">
            <div id="container-bottom">
                <script type='text/javascript' src='//pl26063307.effectiveratecpm.com/19/09/91/1909913ee893cee324321a2b56c090fa.js'></script>
            </div>
            <div class="ad-notice">Anuncio - Gracias por tu apoyo</div>
        </div>
        
        <footer>
            &copy; 2025 Partidos en Vivo - Todos los derechos reservados
        </footer>
    </div>
    
    <script>
        function initializeVideoPlayer(videoElement, streamUrl) {
            // Check if HLS is supported
            if (Hls.isSupported()) {
                const hls = new Hls({
                    // More robust HLS configuration
                    maxBufferLength: 30,  // Seconds of video buffer
                    maxMaxBufferLength: 60,  // Maximum buffer length
                    maxBufferSize: 60 * 1000 * 1000,  // 60 MB buffer size
                    enableWorker: true,  // Use web worker for parsing
                    liveSyncDuration: 30,  // How far behind live point to sync
                    liveMaxLatencyDuration: 60,  // Maximum latency before catching up
                    liveDurationInfinity: true,  // Allow infinite live stream duration
                    
                    // Error handling configuration
                    startPosition: -1,  // Auto start
                    autoStartLoad: true,  // Automatically start loading
                    debug: false  // Set to true for detailed logging
                });

                // Error handling for HLS
                hls.on(Hls.Events.ERROR, function (event, data) {
                    console.error('HLS Error:', data);
                    
                    // Attempt to recover from media errors
                    if (data.fatal) {
                        switch (data.type) {
                            case Hls.ErrorTypes.NETWORK_ERROR:
                                console.log('Fatal network error. Attempting to recover...');
                                hls.startLoad();
                                break;
                            case Hls.ErrorTypes.MEDIA_ERROR:
                                console.log('Fatal media error. Attempting to recover...');
                                hls.recoverMediaError();
                                break;
                            default:
                                hls.destroy();
                                break;
                        }
                    }
                });

                // Load and attach stream
                hls.loadSource(streamUrl);
                hls.attachMedia(videoElement);

                // Ready to play
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    videoElement.play().catch(e => {
                        console.error('Autoplay prevented:', e);
                        // Optional: Add user interaction hint
                        videoElement.setAttribute('playsinline', '');
                        videoElement.setAttribute('webkit-playsinline', '');
                    });
                });
            } 
            // Fallback for browsers with native HLS support
            else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = streamUrl;
                videoElement.addEventListener('loadedmetadata', function() {
                    videoElement.play().catch(e => {
                        console.error('Autoplay prevented:', e);
                    });
                });
            } 
            else {
                console.error('HLS is not supported in this browser');
                // Optional: Show user a browser compatibility message
            }
        }

        function cargarPartido(partidoElement) {
            const streamUrl = partidoElement.getAttribute('data-stream-url');
            if (!streamUrl) {
                console.error('No stream URL found');
                return;
            }

            // Find or create video element
            let videoElement = partidoElement.querySelector('video');
            
            if (!videoElement) {
                videoElement = document.createElement('video');
                videoElement.controls = true;
                videoElement.style.width = '100%';
                videoElement.style.maxHeight = '500px';
                partidoElement.appendChild(videoElement);
            }

            // Remove any existing source elements
            videoElement.innerHTML = '';

            // Set video attributes for better mobile and responsive support
            videoElement.setAttribute('playsinline', '');
            videoElement.setAttribute('webkit-playsinline', '');
            videoElement.setAttribute('x5-playsinline', '');
            
            // Attempt to initialize video player
            initializeVideoPlayer(videoElement, streamUrl);
        }

        function mostrarMasPartidos() {
            alert('Funcionalidad de mostrar m√°s partidos pr√≥ximamente');
        }

        // Add click event listeners to partido elements
        document.addEventListener('DOMContentLoaded', function() {
            const partidoElements = document.querySelectorAll('.partido');
            partidoElements.forEach(partido => {
                partido.addEventListener('click', function() {
                    cargarPartido(this);
                });
            });

            // Ad loading and ad blocker detection
            cargarTodosLosAnuncios();
            detectarBloqueadorAnuncios();
        });

        function cargarTodosLosAnuncios() {
            const adContainers = [
                'ad-top', 
                'ad-mid-1', 
                'ad-mid-2', 
                'ad-bottom'
            ];

            adContainers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container) {
                    try {
                        const script = document.createElement('script');
                        script.type = 'text/javascript';
                        script.async = true;
                        script.src = '//pl26063295.effectiveratecpm.com/2537ae2ea8b16bc9e554273a94dfd098/invoke.js';
                        container.appendChild(script);

                        const adScript = document.createElement('script');
                        adScript.type = 'text/javascript';
                        adScript.src = '//www.highperformanceformat.com/b330ccd204185aee9ef640adccf896d2/invoke.js';
                        container.appendChild(adScript);
                    } catch (e) {
                        console.error(`Error loading ads for ${containerId}:`, e);
                    }
                }
            });
        }

        function detectarBloqueadorAnuncios() {
            setTimeout(function() {
                const adContainers = document.querySelectorAll('.ad-container');
                let adsVisible = false;
                
                adContainers.forEach(container => {
                    if (container.querySelector('iframe') || 
                        container.querySelector('script') || 
                        container.innerHTML.includes('advertisement')) {
                        adsVisible = true;
                    }
                });
                
                if (!adsVisible) {
                    mostrarMensajeDesbloqueo();
                }
            }, 3000);
        }

        function mostrarMensajeDesbloqueo() {
            const mensaje = document.createElement('div');
            mensaje.innerHTML = `
                <div style="
                    padding: 20px; 
                    background-color: #f39c12; 
                    color: #000; 
                    text-align: center; 
                    margin: 20px 0; 
                    border-radius: 8px;
                ">
                    <strong>‚ö†Ô∏è Para una mejor experiencia, por favor desactiva tu bloqueador de anuncios ‚ö†Ô∏è</strong>
                    <br>Nos ayuda a mantener este servicio gratuito. ¬°Gracias!
                </div>`;
            
            document.querySelector('.container').insertBefore(
                mensaje, 
                document.querySelector('.partidos')
            );
        }

        // Periodic ad refresh
        setInterval(cargarTodosLosAnuncios, 30000);
    </script>
</body>
</html>
